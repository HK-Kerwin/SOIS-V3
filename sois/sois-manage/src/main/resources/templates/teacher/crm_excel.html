<div class="row">
    <div class="col-xs-12">
        <div class="box">
            <!-- /.box-header -->
            <div class="box-body table-responsive no-padding">
                <input id="excelFile" name="excelFile" type="file" multiple="multiple" class="form-control pull-right" style="padding-left: 45%"/>
                <input type="button" value="提交" class="form-control pull-right excelUpload"/>
            </div>
        </div>
    </div>
</div>
<script>
    $(document).ready(function () {
        $(".excelUpload").click(function () {
            alert("数据更新中,请稍等");
            let url = "/crm/uploadExcel";

            let formData = new FormData();
            formData.append("excelFile",document.getElementById("excelFile").files[0]);

            $.ajax({
                url: url,
                type: "POST",
                data: formData,
                /**
                 *必须false才会自动加上正确的Content-Type
                 */
                contentType: false,
                /**
                 * 必须false才会避开jQuery对 formdata 的默认处理
                 * XMLHttpRequest会对 formdata 进行正确的处理
                 */
                processData: false,
                success: function (result) {
                    if (result.state === 1) {
                        alert(result.message);
                    } else {
                        alert(result.message);
                    }
                }
            });


        });
    })
    
</script>

